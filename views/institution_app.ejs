<%- include('partials/header') %>

<main class="content">
    <h2>Institution Application</h2>

    <form action="/institution-application/select" method="POST">
        <label for="institution">Select Institution:</label>
        <select id="institution" name="institutionId" required>
            <option value="">--Select an Institution--</option>
            <% institutions.forEach(institution => { %>
                <option value="<%= institution.institution_id %>"><%= institution.institution_name %></option>
            <% }); %>
        </select>
        <button type="submit">View Data</button>
    </form>

    <% if (institutionData) { %>
        <h3>Applications for <%= institutionData.name %>:</h3>

        <% if (institutionData.applications.length > 0) { %>
            <table>
                <thead>
                    <tr>
                        <th>Faculty Name</th>
                        <th>Course Name</th>
                        <th>Number of Applications</th>
                    </tr>
                </thead>
                <tbody>
                    <% institutionData.applications.forEach(app => { %>
                        <tr>
                            <td><%= app.faculty_name %></td>
                            <td><%= app.course_name %></td>
                            <td><%= app.num_applications %></td>
                        </tr>
                    <% }); %>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="2"><strong>Total Distinct Applicants:</strong></td>
                        <td><strong><%= institutionData.distinctStudents %></strong></td>
                    </tr>
                </tfoot>
            </table>
        <% } else { %>
            <p>No application data found for this institution.</p>
        <% } %>
    <% } else if (typeof error !== 'undefined') { %>
        <p class="error-message"><%= error %></p>
    <% } %>
</main>

<%- include('partials/footer') %>

<style>
    /* Add to style.css or embed for specific page styling */
    select {
        padding: 8px;
        margin-right: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }
    table {
        width: 80%;
        border-collapse: collapse;
        margin-top: 20px;
        margin-left: auto;
        margin-right: auto;
    }
    table, th, td {
        border: 1px solid #ddd;
    }
    th, td {
        padding: 10px;
        text-align: left;
    }
    th {
        background-color: #f2f2f2;
    }
    tfoot {
        font-weight: bold;
        background-color: #e6e6e6;
    }
</style>